# 変数集約

### 1 定義

マルチブランチの変数を一つの変数に集約し、ダウンズトリームノードの統一設定を実現します。

変数集約ノード（元変数割り当てノード）はワークフローの重要なノードであり、異なるブランチの出力結果を統合し、どのブランチが実行されても、その結果を一つの統一された変数を通じて参照およびアクセスできるようにします。これはマルチブランチの状況で非常に有用で、異なるブランチで同じ役割を果たす変数を一つの出力変数にマッピングし、ダウンズトリームノードでの重複定義を避けます。

***

### 2 シナリオ

変数集約を通じて、問題分類や条件ブランチなどのマルチ出力をシングル出力に集約し、プロセスのダウンズトリームノードが使用および操作できるようにします。これによりデータフローの管理が簡素化されます。

**問題分類後のマルチ集約**

変数集約を追加しない場合、分類1と分類2のブランチは異なるナレッジベース検索を経て、ダウンズトリームの大規模言語モデルおよび直接返信ノードを繰り返し定義する必要があります。

<figure><img src="../../../.gitbook/assets/image (227).png" alt=""><figcaption><p>問題分類（変数集約なし）</p></figcaption></figure>

変数集約を追加することで、二つのナレッジベース検索ノードの出力を一つの変数に集約できます。

<figure><img src="../../../.gitbook/assets/image (225).png" alt=""><figcaption><p>問題分類後のマルチ集約</p></figcaption></figure>

**IF/ELSE 条件ブランチ後のマルチ集約**

<figure><img src="../../../.gitbook/assets/image (226).png" alt=""><figcaption><p>問題分類後のマルチ集約</p></figcaption></figure>

### 3 フォーマット要求

変数集約器は文字列（`String`）、数値（`Number`）、オブジェクト（`Object`）、および配列（`Array`）など、さまざまなデータ型の集約をサポートします。

**変数集約器は同一データ型の変数しか集約できません**。最初に変数集約ノードに追加された変数データ形式が `String` である場合、後続の接続では追加可能な変数が `String` タイプに自動的にフィルタリングされます。

**アグリゲートグループ**

バージョン0.6.10以降でアグリゲートグループをサポートしています。

アグリゲートグループを有効にすると、変数集約器は複数のグループの変数を集約でき、各グループ内の集約時には同一データ型が求められます。